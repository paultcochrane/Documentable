<!doctype html>
<html lang="en">
<head>
    <title>Testing</title>
    <meta charset="UTF-8"/>
    <meta name=viewport content="width=device-width, initial-scale=1">
    <link rel="icon" href="/Documentable/integration-test/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="/Documentable/integration-test/css/app.css" media="screen" title="default" />
    <noscript> <style> #search { visibility: hidden; } </style> </noscript>
</head>

<body class="pod">

    <div id="___top"></div>

    <div id="header" class="pretty-box green">

        <a href="/Documentable/integration-test/">
            <img src="/Documentable/integration-test/images/Camelia.svg"alt="»ö«"id="logo"width="62"height="48"/> &nbsp;Raku Documentation
        </a>

        <div id="search" class="ui-widget">
            <div class="green">
                <input placeholder="Loading..." id="query" accesskey="f" title="Enter term to search for (hit Esc to focus)"/>
            </div>
            <p id="not-found-message">
                Not in Index (<a href="" id="try-web-search">try site search</a>)
            </p>
        </div>
        
        <div class="menu">
            
            <div class="menu-items dark-green">
                <a class='menu-item darker-green' href='https://raku.org'><strong>Raku homepage</strong></a>
                    <a class="menu-item selected darker-green" href="/Documentable/integration-test/language.html"> Language </a>
                    <a class="menu-item " href="/Documentable/integration-test/type.html"> Types </a>
                    <a class="menu-item " href="/Documentable/integration-test/routine.html"> Routines </a>
                    <a class="menu-item " href="https://webchat.freenode.net/?channels=#raku"> Chat with us </a>
            </div>
            
            
            
        
        </div>
    </div>

    <div id="content" class="pretty-box yellow content_fragment">

        <div align="right" style="display:;">
            <button title="Edit this page"  class="pencil" onclick="location='https://github.com/Raku/doc/tree/master/docs/Language/testing.pod6'">
                <svg width="14px" height="16px" viewBox="0 0 14 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <defs></defs>
                    <g id="Octicons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <g id="pencil" fill="#000000">
                            <path d="M0,12 L0,15 L3,15 L11,7 L8,4 L0,12 L0,12 Z M3,14 L1,14 L1,12 L2,12 L2,13 L3,13 L3,14 L3,14 Z M13.3,4.7 L12,6 L9,3 L10.3,1.7 C10.69,1.31 11.32,1.31 11.71,1.7 L13.3,3.29 C13.69,3.68 13.69,4.31 13.3,4.7 L13.3,4.7 Z" id="Shape"></path>
                        </g>
                    </g>
                </svg>
            </button>
        </div>

        <h1 class="title">Testing</h1>
        <p class="subtitle">Writing and running tests in Raku</p>

        <nav class="indexgroup">
<table id="TOC">
<caption><h2 id="TOC_Title">Table of Contents</h2></caption>
                <tr class="toc-level-1"><td class="toc-number">1</td><td class="toc-text"><a href="#Writing_tests">Writing tests</a></td></tr>
                         <tr class="toc-level-2"><td class="toc-number">1.1</td><td class="toc-text"><a href="#Thread_safety">Thread safety</a></td></tr>
             <tr class="toc-level-1"><td class="toc-number">2</td><td class="toc-text"><a href="#Running_tests">Running tests</a></td></tr>
                                        <tr class="toc-level-1"><td class="toc-number">3</td><td class="toc-text"><a href="#Test_plans">Test plans</a></td></tr>
      <tr class="toc-level-1"><td class="toc-number">4</td><td class="toc-text"><a href="#Testing_return_values">Testing return values</a></td></tr>
             <tr class="toc-level-2"><td class="toc-number">4.1</td><td class="toc-text"><a href="#By_string_comparison">By string comparison</a></td></tr>
     <tr class="toc-level-2"><td class="toc-number">4.2</td><td class="toc-text"><a href="#By_approximate_numeric_comparison">By approximate numeric comparison</a></td></tr>
   <tr class="toc-level-2"><td class="toc-number">4.3</td><td class="toc-text"><a href="#By_structural_comparison">By structural comparison</a></td></tr>
    <tr class="toc-level-2"><td class="toc-number">4.4</td><td class="toc-text"><a href="#By_arbitrary_comparison">By arbitrary comparison</a></td></tr>
    <tr class="toc-level-2"><td class="toc-number">4.5</td><td class="toc-text"><a href="#By_object_type">By object type</a></td></tr>
   <tr class="toc-level-2"><td class="toc-number">4.6</td><td class="toc-text"><a href="#By_method_name">By method name</a></td></tr>
   <tr class="toc-level-2"><td class="toc-number">4.7</td><td class="toc-text"><a href="#By_role">By role</a></td></tr>
      <tr class="toc-level-2"><td class="toc-number">4.8</td><td class="toc-text"><a href="#By_regex">By regex</a></td></tr>
     <tr class="toc-level-1"><td class="toc-number">5</td><td class="toc-text"><a href="#Testing_modules">Testing modules</a></td></tr>
    <tr class="toc-level-1"><td class="toc-number">6</td><td class="toc-text"><a href="#Testing_exceptions">Testing exceptions</a></td></tr>
               <tr class="toc-level-1"><td class="toc-number">7</td><td class="toc-text"><a href="#Grouping_tests">Grouping tests</a></td></tr>
        <tr class="toc-level-1"><td class="toc-number">8</td><td class="toc-text"><a href="#Skipping_tests">Skipping tests</a></td></tr>
          <tr class="toc-level-1"><td class="toc-number">9</td><td class="toc-text"><a href="#Manual_control">Manual control</a></td></tr>
     
</table>
</nav>

        <div class="pod-body ">
            <p>Testing code is an integral part of software development. Tests provide automated, repeatable verifications of code behavior, and ensures your code works as expected.</p>
<p>In Raku, the <a href="/Documentable/integration-test/type/Test">Test</a> module provides a testing framework, used also by Raku&#39;s official spectest suite.</p>
<p>The testing functions emit output conforming to the <a href="https://testanything.org">Test Anything Protocol</a>. In general, they are used in sink context:</p>
<pre class="pod-block-code">ok check-name($meta, :$relaxed-name), &quot;name has a hyphen rather than &#39;::&#39;&quot;
</pre>
<p>but all functions also return as a Boolean if the test has been successful or not, which can be used to print a message if the test fails:</p>
<pre class="pod-block-code">ok check-name($meta, :$relaxed-name), &quot;name has a hyphen rather than &#39;::&#39;&quot; \
  or diag &quot;\nTo use hyphen in name, pass :relaxed-name to check-name\n&quot;;
</pre>
<h1 id="Writing_tests"><a class="u" href="#___top" title="go to top of document">Writing tests</a></h1>
<p>As with any Perl project, the tests live under the <code>t</code> directory in the project&#39;s base directory.</p>
<p>A typical test file looks something like this:</p>
<pre class="pod-block-code">use Test;      # a Standard module included with Rakudo
use lib &#39;lib&#39;;

plan $num-tests;

# .... tests

done-testing;  # optional with &#39;plan&#39;
</pre>
<p>We load the builtin <code>Test</code> module and specify where our other libraries are. We then specify how many tests we <em>plan</em> to run (such that the testing framework can tell us if more or fewer tests were run than we expected) and when finished with the tests, we use <em>done-testing</em> to tell the framework we are done.</p>
<h2 id="Thread_safety"><a class="u" href="#___top" title="go to top of document">Thread safety</a></h2>
<p>Note that routines in <code>Test</code> module are <em>not</em> thread-safe. This means you should not attempt to use the testing routines in multiple threads simultaneously, as the <a href="https://testanything.org/">TAP</a> output might come out of order and confuse the program interpreting it.</p>
<p>There are no current plans to make it thread safe. If threaded-testing is crucial to you, you may find some suitable <a href="https://modules.raku.org/search/?q=Test">ecosystem modules</a> to use instead of <code>Test</code> for your testing needs.</p>
<h1 id="Running_tests"><a class="u" href="#___top" title="go to top of document">Running tests</a></h1>
<p>Tests can be run individually by specifying the test filename on the command line:</p>
<pre class="pod-block-code">$ raku t/test-filename.t
</pre>
<p>To run all tests in the directory recursively, <a href="https://modules.raku.org/dist/App::Prove6">prove6</a> application can be used.</p>
<p>You have to install it before using with zef:</p>
<pre class="pod-block-code">$ zef install App::Prove6
</pre>
<p>You can run <code>prove6</code> in a distribution directory this way:</p>
<pre class="pod-block-code">$ prove6 --lib t/
</pre>
<p>The <code>t/</code> argument specified directory that contains tests and the <code>--lib</code> option is passed to include <code>lib</code> directory into Raku distribution path, it is an equivalent of <code>-Ilib</code> argument of <code>raku</code> command.</p>
<p>For more documentation regarding <code>prove6</code> usage refer to <a href="https://modules.raku.org/dist/App::Prove6">its page</a>.</p>
<p>To abort the test suite upon first failure, set the <code>RAKU_TEST_DIE_ON_FAIL</code> environmental variable:</p>
<pre class="pod-block-code">$ RAKU_TEST_DIE_ON_FAIL=1 raku t/test-filename.t
</pre>
<p>The same variable can be used within the test file. Set it before loading the <code>Test</code> module:</p>
<pre class="pod-block-code">BEGIN %*ENV&lt;RAKU_TEST_DIE_ON_FAIL&gt; = 1;
use Test;
...</pre>
<h1 id="Test_plans"><a class="u" href="#___top" title="go to top of document">Test plans</a></h1>
<p>Tests plans use <a href="/Documentable/integration-test/type/Test#plan"><code>plan</code></a> for declaring how many plans are going to be done or, as might be the case, skipped. If no plan is declared, <a href="/Documentable/integration-test/type/Test#done-testing"><code>done-testing</code></a> is used to declare the end of the tests.</p>
<h1 id="Testing_return_values"><a class="u" href="#___top" title="go to top of document">Testing return values</a></h1>
<p>The <code>Test</code> module exports various functions that check the return value of a given expression and produce standardized test output.</p>
<p>In practice, the expression will often be a call to a function or method that you want to unit-test. <a href="/Documentable/integration-test/type/Test#ok"><code>ok</code></a> and <a href="/Documentable/integration-test/type/Test#nok"><code>nok</code></a> will match <code>True</code> and <code>False</code>. However, where possible it&#39;s better to use one of the specialized comparison test functions below, because they can print more helpful diagnostics output in case the comparison fails.</p>
<h2 id="By_string_comparison"><a class="u" href="#___top" title="go to top of document">By string comparison</a></h2>
<p><a href="/Documentable/integration-test/type/Test#is"><code>is</code></a> and <a href="/Documentable/integration-test/type/Test#isnt"><code>nok</code></a> test for equality using the proper operator, depending on the object (or class) it&#39;s handled.</p>
<h2 id="By_approximate_numeric_comparison"><a class="u" href="#___top" title="go to top of document">By approximate numeric comparison</a></h2>
<p><a href="/Documentable/integration-test/type/Test#is-approx"><code>is-approx</code></a> compares numbers with a certain precision, which can be absolute or relative. It can be useful for numeric values whose precision will depend on the internal representation.</p>
<h2 id="By_structural_comparison"><a class="u" href="#___top" title="go to top of document">By structural comparison</a></h2>
<p>Structures can be also compared using <a href="/Documentable/integration-test/type/Test#is-deeply"><code>is-deeply</code></a>, which will check that internal structures of the objects compared is the same.</p>
<h2 id="By_arbitrary_comparison"><a class="u" href="#___top" title="go to top of document">By arbitrary comparison</a></h2>
<p>You can use any kind of comparison with <a href="/Documentable/integration-test/type/Test#cmp-ok"><code>cmp-ok</code></a>, which takes as an argument the function or operator that you want to be used for comparing.</p>
<h2 id="By_object_type"><a class="u" href="#___top" title="go to top of document">By object type</a></h2>
<p><a href="/Documentable/integration-test/type/Test#isa-ok"><code>isa-ok</code></a> tests whether an object is of a certain type.</p>
<h2 id="By_method_name"><a class="u" href="#___top" title="go to top of document">By method name</a></h2>
<p><a href="/Documentable/integration-test/type/Test#can-ok"><code>can-ok</code></a> is used on objects to check whether they have that particular method.</p>
<h2 id="By_role"><a class="u" href="#___top" title="go to top of document">By role</a></h2>
<ul><li><p><a name="Documentable/integration-test/index-entry-does-ok-does-ok($variable,_$role,_$description?)"><span class="index-entry">does-ok($variable, $role, $description?)</span></a></p>
</li>
</ul>
<p><a href="/Documentable/integration-test/type/Test#does-ok"><code>does-ok</code></a> checks whether the given variable can do a certain <a href="/Documentable/integration-test/language/objects#Roles">Role</a>.</p>
<h2 id="By_regex"><a class="u" href="#___top" title="go to top of document">By regex</a></h2>
<p><a href="/Documentable/integration-test/type/Test#like"><code>like</code></a> and <a href="/Documentable/integration-test/type/Test#unlike"><code>unlike</code></a> check using regular expressions; in the first case passes if a match exists, in the second case when it does not.</p>
<h1 id="Testing_modules"><a class="u" href="#___top" title="go to top of document">Testing modules</a></h1>
<p>Modules are tentatively loaded with <a href="/Documentable/integration-test/type/Test#use-ok"><code>use-ok</code></a>, which fails if they fail to load.</p>
<h1 id="Testing_exceptions"><a class="u" href="#___top" title="go to top of document">Testing exceptions</a></h1>
<p><a href="/Documentable/integration-test/type/Test#dies-ok"><code>dies-ok</code></a> and <a href="/Documentable/integration-test/type/Test#lives-ok"><code>lives-ok</code></a> are opposites ways of testing code; the first checks that it throws an exception, the second that it does not; <a href="/Documentable/integration-test/type/Test#throws-like"><code>throws-like</code></a> checks that the code throws the specific exception it gets handed as an argument; <a href="/Documentable/integration-test/type/Test#fails-like"><code>fails-like</code></a>, similarly, checks if the code returns a specific type of <a href="/Documentable/integration-test/type/Failure">Failure</a>. <a href="/Documentable/integration-test/type/Test#eval-dies-ok"><code>eval-dies-ok</code></a> and <a href="/Documentable/integration-test/type/Test#eval-lives-ok"><code>eval-lives-ok</code></a> work similarly on strings that are evaluated prior to testing.</p>
<h1 id="Grouping_tests"><a class="u" href="#___top" title="go to top of document">Grouping tests</a></h1>
<p>The result of a group of subtests is only <code>ok</code> if all subtests are <code>ok</code>; they are grouped using <a href="/Documentable/integration-test/type/Test#subtest"><code>subtest</code></a>.</p>
<h1 id="Skipping_tests"><a class="u" href="#___top" title="go to top of document">Skipping tests</a></h1>
<p>Sometimes tests just aren&#39;t ready to be run, for instance a feature might not yet be implemented, in which case tests can be marked as <a href="/Documentable/integration-test/type/Test#todo"><code>todo</code></a>. Or it could be the case that a given feature only works on a particular platform - in which case one would <a href="/Documentable/integration-test/type/Test#skip"><code>skip</code></a> the test on other platforms; <a href="/Documentable/integration-test/type/Test#skip-rest"><code>skip-rest</code></a> will skip the remaining tests instead of a particular number given as argument; <a href="/Documentable/integration-test/type/Test#bail-out"><code>bail-out</code></a> will simply exit the tests with a message.</p>
<h1 id="Manual_control"><a class="u" href="#___top" title="go to top of document">Manual control</a></h1>
<p>If the convenience functionality documented above does not suit your needs, you can use the following functions to manually direct the test harness output; <a href="/Documentable/integration-test/type/Test#pass"><code>pass</code></a> will say a test has passed, and <a href="/Documentable/integration-test/type/Test#diag"><code>diag</code></a> will print a (possibly) informative message.</p>

        </div>
    </div>

    

    <footer class="pretty-box yellow">
        <p>
            Generated from <a href="https://github.com/Raku/doc/tree/master/docs/Language/testing.pod6">https://github.com/Raku/doc/tree/master/docs/Language/testing.pod6</a>.
        </p>
        <p>
            This is a work in progress to document Raku (formerly known as Perl 6), and
            known to be incomplete.
        </p>
        <p>
            <a href="https://github.com/raku/doc/blob/master/CONTRIBUTING.md#reporting-bugs">
                Please report any issues
            </a>
            Your contribution is appreciated.
        </p>
        <p>
            This documentation is provided under the terms of the
            <a href="https://raw.githubusercontent.com/raku/doc/master/LICENSE">
                Artistic License 2.0
            </a>. The Camelia image is
            <a href="https://raw.githubusercontent.com/raku/mu/master/misc/camelia.txt">
                copyright © 2009 by Larry Wall.
            </a>
            <!-- CREDITS -->
            <!--External Link Image by Zapyon, CCA-SA 4.0. Derived from Wikimedia Foundation https://commons.wikimedia.org/wiki/File:External-link-04-bold-12x12.svg -->
        </p>
    </footer>

    <script type="text/javascript" src="/Documentable/integration-test/js/app.js?v=1"></script>
    <script type="text/javascript" src="/Documentable/integration-test/js/search.js?v=3"></script>
</body>
</html>

